# 数据库自增id和数据库的replace into实现

replace into首先尝试先插入数据，如果发现已经有此行数据（根据主键或者唯一索引判断）则先删除，再插入；否则直接插入数据。
**不同的微服务根据不同的起始值和步长来区分唯一**
**每次获取都需要一次读写，性能较为低下**
**无法水平扩展，新增一个服务就不能支持了**

# 基于redis的全局唯一ID

Redis单线程保证原子性，使用INCR和INCYBY来做
还可以通过redis集群来获得更高的吞吐量
假设有5台，每台初始化值1，2，3，4，5，步长都是5


# 雪花算法 snowflake

生成的是一个64bit的整数，long型，转换成字符串最多19位

**1bit符号位+41bit位时间戳位+10bit工作进程位+12bit序列号位**

符号位：永远为0；即永远是正数
时间戳位：范围最大约是69.73年，从1970年到2039年
工作进程编号：1024；工作机器的id
序列号：用来记录毫秒内产生的不同id表示同一个时间截内产生的4095个ID序号

如果不同机器的时间片不是相同的，可能会造成不是全局递增的